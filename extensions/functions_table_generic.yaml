%YAML 1.2
---
urn: extension:io.substrait:functions_table_generic
table_functions:
  - name: explode
    description: >-
      Produces one row per array element.

      For each input row, this function generates one output row for each element
      in the input array. The output is a struct with a single field 'value'
      containing the array element.

      Empty arrays produce zero output rows. For outer semantics (producing a row
      with NULL when the array is empty), use GenerateRel's preserve_on_empty option.
    impls:
      - args:
          - name: input
            value: list<any1>
            description: The array to explode.
        return: struct<any1>

  - name: explode
    description: >-
      Produces one row per map entry.

      For each input row, this function generates one output row for each key-value
      pair in the input map. The output is a struct with two fields: 'key' and 'value'.
      Note that map entries may be visited in any order.

      Empty maps produce zero output rows. For outer semantics (producing a row
      with NULLs when the map is empty), use GenerateRel's preserve_on_empty option.

      Some systems call this unnest.
    impls:
      - args:
          - name: input
            value: map<any1, any2>
            description: The map to explode.
        return: struct<any1, any2>

  - name: posexplode
    description: >-
      Produces one row per array element with position.

      For each input row, this function generates one output row for each element
      in the input array. The output is a struct with two fields:
      - 'pos': 0-indexed position of the element in the array (i64)
      - 'value': the array element

      Empty arrays produce zero output rows. For outer semantics (producing a row
      with NULLs when the array is empty), use GenerateRel's preserve_on_empty option.
    impls:
      - args:
          - name: input
            value: list<any1>
            description: The array to explode with positions.
        return: struct<i64, any1>

  - name: unnest
    description: >-
      Expands one or more lists into rows by zipping them in parallel (PostgreSQL semantics).

      When multiple lists are provided, produces rows by expanding the lists in parallel,
      similar to a zip operation. For example, unnest([1,2], [3,4]) produces rows: (1,3), (2,4).

      If lists have different lengths, shorter lists are padded with NULL values to match
      the length of the longest list.

      Empty lists (when all inputs are empty) produce zero output rows. For outer semantics
      (producing a row with NULLs when all lists are empty), use GenerateRel's preserve_on_empty option.
    impls:
      - args:
          - name: input
            value: list<any1>
            description: The array to unnest.
        return: struct<any1>
      - args:
          - name: input1
            value: list<any1>
            description: First array to unnest.
          - name: input2
            value: list<any2>
            description: Second array to unnest.
        return: struct<any1, any2>
      - args:
          - name: input1
            value: list<any1>
            description: First array to unnest.
          - name: input2
            value: list<any2>
            description: Second array to unnest.
          - name: input3
            value: list<any3>
            description: Third array to unnest.
        return: struct<any1, any2, any3>
      - args:
          - name: input1
            value: list<any1>
            description: First array to unnest.
          - name: input2
            value: list<any2>
            description: Second array to unnest.
          - name: input3
            value: list<any3>
            description: Third array to unnest.
          - name: input4
            value: list<any4>
            description: Fourth array to unnest.
        return: struct<any1, any2, any3, any4>
