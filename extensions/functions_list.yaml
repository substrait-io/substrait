%YAML 1.2
---
urn: extension:io.substrait:functions_list
scalar_functions:
  - name: "transform"
    description: >-
      Transforms each element of a list using the provided function.
      Also known as "map" in functional programming.

      Returns a new list where each element is the result of applying
      the transformer to the corresponding element in the input list.

      The transformer receives one parameter (the current element) and must return
      the transformed value.
    impls:
      - args:
          - name: input
            value: list<any1>
          - name: transformer
            value: func<any1 -> any2>
        nullability: MIRROR
        return: list<any2>

  - name: "filter"
    description: >-
      Filters a list of elements based on a predicate function.

      Returns a new list containing only elements for which the predicate
      function returns true.

      The predicate receives one parameter (the current element) and must return a
      boolean.

      Elements for which the predicate returns true are included in the
      result. Elements for which the predicate returns false or null are excluded.
    impls:
      - args:
          - name: input
            value: list<any1>
          - name: predicate
            value: func<any1 -> boolean>
        nullability: MIRROR
        return: list<any1>

  - name: "cardinality"
    description: >-
      Returns the number of elements in the list.

      Null elements are counted. If the input list is null, the result is null.
    impls:
      - args:
          - name: input
            value: list<any1>
        nullability: MIRROR
        return: i64

  - name: "sort"
    description: >-
      Sorts the elements of a list.

      When called with just a list, sorts in ascending order with null elements
      placed at the end.

      When called with a comparator function, the comparator receives two elements
      and must return a negative integer if the first is less than the second,
      zero if they are equal, or a positive integer if the first is greater.
      If the comparator returns null, the behavior is undefined.

      If the input list is null, the result is null.

      Note: Test cases for the comparator overload require a compare function
      that returns i32, which is not currently available in the extensions.
    impls:
      - args:
          - name: input
            value: list<any1>
        nullability: MIRROR
        return: list<any1>
      - args:
          - name: input
            value: list<any1>
          - name: comparator
            value: func<any1, any1 -> i32>
        nullability: MIRROR
        return: list<any1>

  - name: "any_match"
    description: >-
      Returns true if any element of the list matches the predicate.

      The predicate function is applied to each element. Returns true if the
      predicate returns true for at least one element, false otherwise.

      For an empty list, returns false.
      Null predicate results are ignored when determining the result.
      If the input list is null, the result is null.
    impls:
      - args:
          - name: input
            value: list<any1>
          - name: predicate
            value: func<any1 -> boolean>
        nullability: MIRROR
        return: boolean

  - name: "all_match"
    description: >-
      Returns true if all elements of the list match the predicate.

      The predicate function is applied to each element. Returns true if the
      predicate returns true for all elements, false if any element returns false.

      For an empty list, returns true (vacuously true).
      Null predicate results are ignored when determining the result.
      If the input list is null, the result is null.
    impls:
      - args:
          - name: input
            value: list<any1>
          - name: predicate
            value: func<any1 -> boolean>
        nullability: MIRROR
        return: boolean
