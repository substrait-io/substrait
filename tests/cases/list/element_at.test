### SUBSTRAIT_SCALAR_TEST: v1.0
### SUBSTRAIT_INCLUDE: '/extensions/functions_list.yaml'

# basic: Basic element access (1-based indexing)
element_at([10, 20, 30]::list<i32>, 1::i64) [negative_index_behavior:FROM_END] = 10::i32
element_at([10, 20, 30]::list<i32>, 2::i64) [negative_index_behavior:FROM_END] = 20::i32
element_at([10, 20, 30]::list<i32>, 3::i64) [negative_index_behavior:FROM_END] = 30::i32
element_at(['a', 'b', 'c']::list<string>, 2::i64) [negative_index_behavior:FROM_END] = 'b'::string

# negative_index_from_end: Negative indices count from end with FROM_END option
element_at([10, 20, 30]::list<i32>, -1::i64) [negative_index_behavior:FROM_END] = 30::i32
element_at([10, 20, 30]::list<i32>, -2::i64) [negative_index_behavior:FROM_END] = 20::i32
element_at([10, 20, 30]::list<i32>, -3::i64) [negative_index_behavior:FROM_END] = 10::i32

# negative_index_null: Negative indices return null with NULL option
element_at([10, 20, 30]::list<i32>, -1::i64) [negative_index_behavior:NULL] = null::i32
element_at([10, 20, 30]::list<i32>, -2::i64) [negative_index_behavior:NULL] = null::i32

# out_of_bounds: Out of bounds returns null
element_at([10, 20, 30]::list<i32>, 0::i64) [negative_index_behavior:FROM_END] = null::i32
element_at([10, 20, 30]::list<i32>, 4::i64) [negative_index_behavior:FROM_END] = null::i32
element_at([10, 20, 30]::list<i32>, -4::i64) [negative_index_behavior:FROM_END] = null::i32
element_at([]::list<i32>, 1::i64) [negative_index_behavior:FROM_END] = null::i32

# nullable_elements: Element at index is null
element_at([1, Null, 3]::list<i32?>, 2::i64) [negative_index_behavior:FROM_END] = null::i32

# null_index: Null index returns null
element_at([1, 2, 3]::list<i32>, null::i64) [negative_index_behavior:FROM_END] = null::i32
